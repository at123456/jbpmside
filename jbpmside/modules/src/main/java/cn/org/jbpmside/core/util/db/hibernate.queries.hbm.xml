<?xml version="1.0"?>

<!DOCTYPE hibernate-mapping PUBLIC
        "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
        "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">

<hibernate-mapping>
    <!--获取已办列表-->
    <query name="TaskMgmtSession.findCompletedTaskInstancesByActorId">
        <![CDATA[
      select ti
      from org.jbpm.taskmgmt.exe.TaskInstance as ti
      where ti.actorId = :actorId
        and ti.isOpen = false
    ]]>
    </query>
    <!--获取待办待签列表-->
    <query name="TaskMgmtSession.findTodoSignTaskInstancesByActorId">
        <![CDATA[
      select ti
      from org.jbpm.taskmgmt.exe.TaskInstance as ti
      where ti.actorId = :actorId
         and ti.start is null
    ]]>
    </query>
    <!--获取已签列表-->
    <query name="TaskMgmtSession.findAlreadySignTaskInstancesByActorId">
        <![CDATA[
      select ti
      from org.jbpm.taskmgmt.exe.TaskInstance as ti
      where ti.actorId = :actorId
         and ti.start is not null
    ]]>
    </query>
    <!--获取办结列表-->
    <query name="TaskMgmtSession.findProcessCompeletedTaskInstancesByActorId">
        <![CDATA[
      select distinct ti
      from org.jbpm.graph.exe.ProcessInstance pi
           , org.jbpm.taskmgmt.exe.TaskInstance ti
          where pi.rootToken.id = ti.token.id
        and  ti.actorId = :actorId
        and pi.end is not null  
    ]]>
    </query>
</hibernate-mapping>
