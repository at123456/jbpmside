<?xml version="1.0" encoding="GB2312"?>
<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN//EN" "http://www.springframework.org/dtd/spring-beans.dtd">

<beans default-autowire="byName">
    <!--初始化配置文件-->
    <bean id="propertyConfigurer" class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
        <property name="location" value="classpath:runtimeParam.properties"/>
    </bean>
    <!--dataSource-->

    <bean id="dataSource" class="org.springframework.jndi.JndiObjectFactoryBean">
        <property name="jndiName">
            <value>${jbpmside.database.datasourcename}</value>
        </property>
    </bean>

    <!--sessionFactory-->
    <bean id="sessionFactory" class="org.springframework.orm.hibernate3.LocalSessionFactoryBean">
        <property name="dataSource">
            <ref bean="dataSource"/>
        </property>
        
        <property name="mappingResources">
            <list>
            </list>
        </property>

        <property name="mappingJarLocations">
            <list>
                <!--<value>WEB-INF/lib/jbpmside*.jar</value>-->
            </list>
        </property>

        <property name="mappingDirectoryLocations">
            <list>
                <value>WEB-INF/mappings</value>
            </list>
        </property>

        <property name="hibernateProperties">
            <ref bean="jbpmsideHibernateProperties"/>
        </property>
    </bean>

    <!--jbpmsideHibernateProperties-->
    <bean id="jbpmsideHibernateProperties" class="org.springframework.beans.factory.config.PropertiesFactoryBean">
        <property name="properties">
            <props>
                <prop key="hibernate.dialect">${jbpmside.database.dialect}</prop>
                <prop key="hibernate.cache.provider_class">org.hibernate.cache.EhCacheProvider</prop>
                <prop key="hibernate.hibernate.cglib.use_reflection_optimizer">false</prop>
                <prop key="hibernate.hbm2ddl.auto">${jbpmside.hbm2ddl.auto}</prop>
                <prop key="hibernate.cache.use_query_cache">${jbpmside.database.querycache}</prop>
                <prop key="hibernate.show_sql">${jbpmside.database.showsql}</prop>
                <prop key="hibernate.connection.release_mode">after_transaction</prop>
            </props>
        </property>
    </bean>


     <!--流程实例服务-->
    <bean id="jbpmProcessInstanceService"
          class="cn.org.jbpmside.core.services.process.impl.JbpmProcessInstanceServiceImpl"/>
    <!--流程发布-->
    <bean id="ideployJbpmProcessService"
          class="cn.org.jbpmside.core.services.process.impl.DeployJbpmProcessServiceImpl"></bean>
    <!--流程定义-->
    <bean id="jbpmProcessDefinitionService"
          class="cn.org.jbpmside.core.services.process.impl.JbpmProcessDefinitionServiceImpl"></bean>
    <!--工作项列表-->
    <bean id="jbpmWorklistQueryService"
          class="cn.org.jbpmside.core.services.task.impl.JbpmWorklistQueryServiceImpl"></bean>
    <!--数据库操作-->
</beans>